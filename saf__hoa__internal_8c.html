<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="google" content="notranslate" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SAF: framework/modules/saf_hoa/saf_hoa_internal.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-498Z1C2LX5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-498Z1C2LX5');
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SAF
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('saf__hoa__internal_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">saf_hoa_internal.c File Reference<div class="ingroups"><a class="el" href="group___h_o_a.html">saf_hoa</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Internal source for the higher-order Ambisonics module (<a class="el" href="saf_8h.html#a9c2c7080a25d54c9d7bc99588935ea8f" title="SAF Module: HOA.">SAF_HOA_MODULE</a>)  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="saf__hoa_8h_source.html">../saf_hoa/saf_hoa.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="saf__hoa__internal_8h_source.html">../saf_hoa/saf_hoa_internal.h</a>&quot;</code><br />
</div>
<p><a href="saf__hoa__internal_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1688b1a77d8f550c93fb4fc48d23a160" id="r_a1688b1a77d8f550c93fb4fc48d23a160"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1688b1a77d8f550c93fb4fc48d23a160">getEPAD</a> (int order, float *ls_dirs_deg, int nLS, float *decMtx)</td></tr>
<tr class="memdesc:a1688b1a77d8f550c93fb4fc48d23a160"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the Energy preserving Ambisonic decoder (EPAD), as detailed in [1].  <br /></td></tr>
<tr class="separator:a1688b1a77d8f550c93fb4fc48d23a160"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b3622325d0b867730cafe405d0cc6cc" id="r_a7b3622325d0b867730cafe405d0cc6cc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7b3622325d0b867730cafe405d0cc6cc">getAllRAD</a> (int order, float *ls_dirs_deg, int nLS, float *decMtx)</td></tr>
<tr class="memdesc:a7b3622325d0b867730cafe405d0cc6cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the All-round Ambisonics decoder (AllRAD), as detailed in [1], which is essentially a spherical harmonic approximation of VBAP patterns for the target loudspeaker setup.  <br /></td></tr>
<tr class="separator:a7b3622325d0b867730cafe405d0cc6cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bbdd392aae72987779019353f429643" id="r_a5bbdd392aae72987779019353f429643"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5bbdd392aae72987779019353f429643">getBinDecoder_LS</a> (float_complex *hrtfs, float *hrtf_dirs_deg, int N_dirs, int N_bands, int order, float *weights, float_complex *decMtx)</td></tr>
<tr class="memdesc:a5bbdd392aae72987779019353f429643"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes a standard least-squares (LS) binaural ambisonic decoder.  <br /></td></tr>
<tr class="separator:a5bbdd392aae72987779019353f429643"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d606a16cebf5e87e83465e9bc7f9d06" id="r_a1d606a16cebf5e87e83465e9bc7f9d06"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1d606a16cebf5e87e83465e9bc7f9d06">getBinDecoder_LSDIFFEQ</a> (float_complex *hrtfs, float *hrtf_dirs_deg, int N_dirs, int N_bands, int order, float *weights, float_complex *decMtx)</td></tr>
<tr class="memdesc:a1d606a16cebf5e87e83465e9bc7f9d06"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes a least-squares (LS) binaural ambisonic decoder with diffuse-field equalisation [1].  <br /></td></tr>
<tr class="separator:a1d606a16cebf5e87e83465e9bc7f9d06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ae1d9234ebffb4d901a82524e925f07" id="r_a2ae1d9234ebffb4d901a82524e925f07"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2ae1d9234ebffb4d901a82524e925f07">getBinDecoder_SPR</a> (float_complex *hrtfs, float *hrtf_dirs_deg, int N_dirs, int N_bands, int order, float *weights, float_complex *decMtx)</td></tr>
<tr class="memdesc:a2ae1d9234ebffb4d901a82524e925f07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes a binaural ambisonic decoder based on spatial resampling (i.e, virtual loudspeaker decoding) [1].  <br /></td></tr>
<tr class="separator:a2ae1d9234ebffb4d901a82524e925f07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a138f39eb021a09200594f8759932b9af" id="r_a138f39eb021a09200594f8759932b9af"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a138f39eb021a09200594f8759932b9af">getBinDecoder_TA</a> (float_complex *hrtfs, float *hrtf_dirs_deg, int N_dirs, int N_bands, int order, float *freqVector, float *itd_s, float *weights, float_complex *decMtx)</td></tr>
<tr class="memdesc:a138f39eb021a09200594f8759932b9af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes a binaural ambisonic decoder based on the time-alignment (TA) method described in [1].  <br /></td></tr>
<tr class="separator:a138f39eb021a09200594f8759932b9af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d0576b5663ac924cfce80e88e33f97d" id="r_a5d0576b5663ac924cfce80e88e33f97d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5d0576b5663ac924cfce80e88e33f97d">getBinDecoder_MAGLS</a> (float_complex *hrtfs, float *hrtf_dirs_deg, int N_dirs, int N_bands, int order, float *freqVector, float *weights, float_complex *decMtx)</td></tr>
<tr class="memdesc:a5d0576b5663ac924cfce80e88e33f97d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes a binaural ambisonic decoder based on the magnitude least-squares (MagLS) method, first described in [1], with the algorithm given in [2].  <br /></td></tr>
<tr class="separator:a5d0576b5663ac924cfce80e88e33f97d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Internal source for the higher-order Ambisonics module (<a class="el" href="saf_8h.html#a9c2c7080a25d54c9d7bc99588935ea8f" title="SAF Module: HOA.">SAF_HOA_MODULE</a>) </p>
<p>A collection of Ambisonics related functions. Many of which are derived from the MATLAB library found in [1].</p>
<dl class="section see"><dt>See also</dt><dd>[1] <a href="https://github.com/polarch/Higher-Order-Ambisonics">https://github.com/polarch/Higher-Order-Ambisonics</a> Copyright (c) 2015, Archontis Politis, BSD-3-Clause License</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Leo McCormack </dd></dl>
<dl class="section date"><dt>Date</dt><dd>19.03.2018 </dd></dl>
<dl class="section user"><dt>License</dt><dd>ISC </dd></dl>

<p class="definition">Definition in file <a class="el" href="saf__hoa__internal_8c_source.html">saf_hoa_internal.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a7b3622325d0b867730cafe405d0cc6cc" name="a7b3622325d0b867730cafe405d0cc6cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b3622325d0b867730cafe405d0cc6cc">&#9670;&#160;</a></span>getAllRAD()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getAllRAD </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>order</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>ls_dirs_deg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nLS</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>decMtx</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the All-round Ambisonics decoder (AllRAD), as detailed in [1], which is essentially a spherical harmonic approximation of VBAP patterns for the target loudspeaker setup. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">order</td><td>Decoding order </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ls_dirs_deg</td><td>Loudspeaker directions in DEGREES [azi elev]; FLAT: nLS x 2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nLS</td><td>Number of loudspeakers </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">decMtx</td><td>Decoding matrix; FLAT: nLS x (order+1)^2</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>[1] Zotter, F., Frank, M. (2012). All-Round Ambisonic Panning and Decoding. Journal of the Audio Engineering Society, 60(10), 807:820 </dd></dl>

<p class="definition">Definition at line <a class="el" href="saf__hoa__internal_8c_source.html#l00100">100</a> of file <a class="el" href="saf__hoa__internal_8c_source.html">saf_hoa_internal.c</a>.</p>

</div>
</div>
<a id="a5bbdd392aae72987779019353f429643" name="a5bbdd392aae72987779019353f429643"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5bbdd392aae72987779019353f429643">&#9670;&#160;</a></span>getBinDecoder_LS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getBinDecoder_LS </td>
          <td>(</td>
          <td class="paramtype">float_complex *</td>          <td class="paramname"><span class="paramname"><em>hrtfs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>hrtf_dirs_deg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>N_dirs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>N_bands</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>order</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>weights</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float_complex *</td>          <td class="paramname"><span class="paramname"><em>decMtx</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes a standard least-squares (LS) binaural ambisonic decoder. </p>
<p>The binaural ambisonic decoder is computed for each frequency bin/band, ready to be applied to input SH signals in the time-frequency domain, or, take the inverse-FFT and apply it via matrix convolution.</p>
<dl class="section note"><dt>Note</dt><dd>This standard LS decoder typically produces strong timbral colourations in the output when using lower-order input. This is due to input order truncation, since the HRTF grid is typically of much higher modal order than that of the input order. This colouration especially affects high- frequencies, since high-frequency energy is predominantly concentrated in the higher-order components so is then lost by truncating the input order. This phenomenon therefore gets worse when increasing the number of HRTFs in the set.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hrtfs</td><td>The HRTFs; FLAT: N_bands x <a class="el" href="group___utilities.html#ga39b45c9e65aebd2a8ef72c3081baea84" title="2 (true for most humans)">NUM_EARS</a> x N_dirs </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hrtf_dirs_deg</td><td>HRTF directions; FLAT: N_dirs x 2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N_dirs</td><td>Number of HRTF directions in set </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N_bands</td><td>Number of frequency bands/bins </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">order</td><td>Decoding order </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">weights</td><td>Integration weights (set to NULL if not available); N_dirs x 1 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">decMtx</td><td>Decoding matrix; FLAT: N_bands x <a class="el" href="group___utilities.html#ga39b45c9e65aebd2a8ef72c3081baea84" title="2 (true for most humans)">NUM_EARS</a> x (order+1)^2 </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="saf__hoa__internal_8c_source.html#l00162">162</a> of file <a class="el" href="saf__hoa__internal_8c_source.html">saf_hoa_internal.c</a>.</p>

</div>
</div>
<a id="a1d606a16cebf5e87e83465e9bc7f9d06" name="a1d606a16cebf5e87e83465e9bc7f9d06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d606a16cebf5e87e83465e9bc7f9d06">&#9670;&#160;</a></span>getBinDecoder_LSDIFFEQ()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getBinDecoder_LSDIFFEQ </td>
          <td>(</td>
          <td class="paramtype">float_complex *</td>          <td class="paramname"><span class="paramname"><em>hrtfs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>hrtf_dirs_deg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>N_dirs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>N_bands</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>order</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>weights</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float_complex *</td>          <td class="paramname"><span class="paramname"><em>decMtx</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes a least-squares (LS) binaural ambisonic decoder with diffuse-field equalisation [1]. </p>
<p>The binaural ambisonic decoder is computed for each frequency bin/band, ready to be applied to input SH signals in the time-frequency domain, or, take the inverse-FFT and apply it via matrix convolution.</p>
<dl class="section note"><dt>Note</dt><dd>This equalisation mitagates some of the timbral colourations exhibited by standard LS decoding; especially at lower input orders.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hrtfs</td><td>The HRTFs; FLAT: N_bands x <a class="el" href="group___utilities.html#ga39b45c9e65aebd2a8ef72c3081baea84" title="2 (true for most humans)">NUM_EARS</a> x N_dirs </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hrtf_dirs_deg</td><td>HRTF directions; FLAT: N_dirs x 2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N_dirs</td><td>Number of HRTF directions in set </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N_bands</td><td>Number of frequency bands/bins </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">order</td><td>Decoding order </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">weights</td><td>Integration weights (set to NULL if not available); N_dirs x 1 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">decMtx</td><td>Decoding matrix; FLAT: N_bands x <a class="el" href="group___utilities.html#ga39b45c9e65aebd2a8ef72c3081baea84" title="2 (true for most humans)">NUM_EARS</a> x (order+1)^2</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>[1] Z. Ben-Hur, F. Brinkmann, J. Sheaffer, S. Weinzierl, and B. Rafaely, "Spectral equalization in binaural signals represented by order-
         truncated spherical harmonics," The Journal of the Acoustical Society of America, vol. 141, no. 6, pp. 4087&ndash;4096, 2017. </dd></dl>

<p class="definition">Definition at line <a class="el" href="saf__hoa__internal_8c_source.html#l00230">230</a> of file <a class="el" href="saf__hoa__internal_8c_source.html">saf_hoa_internal.c</a>.</p>

</div>
</div>
<a id="a5d0576b5663ac924cfce80e88e33f97d" name="a5d0576b5663ac924cfce80e88e33f97d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d0576b5663ac924cfce80e88e33f97d">&#9670;&#160;</a></span>getBinDecoder_MAGLS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getBinDecoder_MAGLS </td>
          <td>(</td>
          <td class="paramtype">float_complex *</td>          <td class="paramname"><span class="paramname"><em>hrtfs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>hrtf_dirs_deg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>N_dirs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>N_bands</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>order</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>freqVector</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>weights</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float_complex *</td>          <td class="paramname"><span class="paramname"><em>decMtx</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes a binaural ambisonic decoder based on the magnitude least-squares (MagLS) method, first described in [1], with the algorithm given in [2]. </p>
<p>The binaural ambisonic decoder is computed for each frequency bin/band, ready to be applied to input SH signals in the time-frequency domain, or, take the inverse-FFT and apply it via matrix convolution.</p>
<dl class="section note"><dt>Note</dt><dd>Mag-LS operates under similar principles held by the TA/TAC decoder, differing in the manner in which the phase is neglected at frequencies above 1.5kHz.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hrtfs</td><td>The HRTFs; FLAT: N_bands x <a class="el" href="group___utilities.html#ga39b45c9e65aebd2a8ef72c3081baea84" title="2 (true for most humans)">NUM_EARS</a> x N_dirs </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hrtf_dirs_deg</td><td>HRTF directions; FLAT: N_dirs x 2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N_dirs</td><td>Number of HRTF directions in set </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N_bands</td><td>Number of frequency bands/bins </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">order</td><td>Decoding order </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">freqVector</td><td>Frequency vector; N_bands x 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">weights</td><td>Integration weights (set to NULL if not available); N_dirs x 1 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">decMtx</td><td>Decoding matrix; FLAT: N_bands x <a class="el" href="group___utilities.html#ga39b45c9e65aebd2a8ef72c3081baea84" title="2 (true for most humans)">NUM_EARS</a> x (order+1)^2</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>[1] Scho"rkhuber C, Zaunschirm M, Ho"ldrich R. Binaural Rendering of Ambisonic Signals via Magnitude Least Squares. InProceedings of the DAGA 2018 (Vol. 44, pp. 339&ndash;342). </dd>
<dd>
[2] Zotter, F., &amp; Frank, M. (2019). Ambisonics. Springer Open. </dd></dl>

<p class="definition">Definition at line <a class="el" href="saf__hoa__internal_8c_source.html#l00526">526</a> of file <a class="el" href="saf__hoa__internal_8c_source.html">saf_hoa_internal.c</a>.</p>

</div>
</div>
<a id="a2ae1d9234ebffb4d901a82524e925f07" name="a2ae1d9234ebffb4d901a82524e925f07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ae1d9234ebffb4d901a82524e925f07">&#9670;&#160;</a></span>getBinDecoder_SPR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getBinDecoder_SPR </td>
          <td>(</td>
          <td class="paramtype">float_complex *</td>          <td class="paramname"><span class="paramname"><em>hrtfs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>hrtf_dirs_deg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>N_dirs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>N_bands</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>order</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>weights</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float_complex *</td>          <td class="paramname"><span class="paramname"><em>decMtx</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes a binaural ambisonic decoder based on spatial resampling (i.e, virtual loudspeaker decoding) [1]. </p>
<p>The binaural ambisonic decoder is computed for each frequency bin/band, ready to be applied to input SH signals in the time-frequency domain, or, take the inverse-FFT and apply it via matrix convolution.</p>
<dl class="section note"><dt>Note</dt><dd>Like <a class="el" href="saf__hoa__internal_8h.html#a1d606a16cebf5e87e83465e9bc7f9d06" title="Computes a least-squares (LS) binaural ambisonic decoder with diffuse-field equalisation [1].">getBinDecoder_LSDIFFEQ()</a> this method mitagates some of the timbral colourations exhibited by standard LS decoding at lower input orders. However, it operates without equalisation. Instead, the modal order of the HRTF grid is brought closer to the decoding order by simply reducing the number of HRTF points. The LS decoder is then computed using this reduced HRTF set. Therefore, rather than assigning high- frequency energy to higher-order components and subsequently discarding it due to order truncation, the energy is instead aliased back into the lower-order components and preserved.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hrtfs</td><td>The HRTFs; FLAT: N_bands x <a class="el" href="group___utilities.html#ga39b45c9e65aebd2a8ef72c3081baea84" title="2 (true for most humans)">NUM_EARS</a> x N_dirs </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hrtf_dirs_deg</td><td>HRTF directions; FLAT: N_dirs x 2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N_dirs</td><td>Number of HRTF directions in set </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N_bands</td><td>Number of frequency bands/bins </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">order</td><td>Decoding order </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">weights</td><td>Integration weights (set to NULL if not available); N_dirs x 1 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">decMtx</td><td>Decoding matrix; FLAT: N_bands x <a class="el" href="group___utilities.html#ga39b45c9e65aebd2a8ef72c3081baea84" title="2 (true for most humans)">NUM_EARS</a> x (order+1)^2</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>[1] B. Bernschu"tz, A. V. Giner, C. Po"rschmann, and J. Arend, "Binaural
         reproduction of plane waves with reduced modal order" Acta Acustica united with Acustica, vol. 100, no. 5, pp. 972&ndash;983, 2014. </dd></dl>

<p class="definition">Definition at line <a class="el" href="saf__hoa__internal_8c_source.html#l00332">332</a> of file <a class="el" href="saf__hoa__internal_8c_source.html">saf_hoa_internal.c</a>.</p>

</div>
</div>
<a id="a138f39eb021a09200594f8759932b9af" name="a138f39eb021a09200594f8759932b9af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a138f39eb021a09200594f8759932b9af">&#9670;&#160;</a></span>getBinDecoder_TA()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getBinDecoder_TA </td>
          <td>(</td>
          <td class="paramtype">float_complex *</td>          <td class="paramname"><span class="paramname"><em>hrtfs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>hrtf_dirs_deg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>N_dirs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>N_bands</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>order</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>freqVector</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>itd_s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>weights</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float_complex *</td>          <td class="paramname"><span class="paramname"><em>decMtx</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes a binaural ambisonic decoder based on the time-alignment (TA) method described in [1]. </p>
<p>The binaural ambisonic decoder is computed for each frequency bin/band, ready to be applied to input SH signals in the time-frequency domain, or, take the inverse-FFT and apply it via matrix convolution.</p>
<dl class="section note"><dt>Note</dt><dd>Since the standard LS decoder is unable to sufficiently fit lower-order spherical harmonics to the highly directive HRTF patterns, this approach addresses this by conducting preliminary time-alignment of the Head-related impulse responses (HRIRs), which aids the LS fitting. This method essentially exploits prior knowledge of the bandwidth in which the inter-aural level differences (ILDs) are the dominant localisation cues; which is above approximately 1.5 kHz. By discarding the phase information of the HRTFs at frequencies above 1.5 kHz, the LS fitting instead prioritises the delivery of the correct magnitude responses; rather than the phase. Thus it ultimately yields improved ILD cues and diminished inter-aural time difference (ITD) cues, but in a frequency range where ILD cues are more important for localisation. This method, therefore, mitagates many of the localisation deficiencies compared with the standard LS decoding at lower input orders. </dd>
<dd>
The paper [1] also detailed a diffuse-field covariance constraint, and the original accronym was TAC (C=contrained), however, in SAF, this constraint is implemented as an independent operation. One may impose this constraint on any binaural decoder using the <a class="el" href="group___h_o_a.html#ga1cc8fcc9d1b9981fbc9e6097c97495d4" title="Imposes a diffuse-field covariance constraint on a given binaural decoding matrix,...">applyDiffCovMatching()</a> function.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hrtfs</td><td>The HRTFs; FLAT: N_bands x <a class="el" href="group___utilities.html#ga39b45c9e65aebd2a8ef72c3081baea84" title="2 (true for most humans)">NUM_EARS</a> x N_dirs </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hrtf_dirs_deg</td><td>HRTF directions; FLAT: N_dirs x 2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N_dirs</td><td>Number of HRTF directions in set </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N_bands</td><td>Number of frequency bands/bins </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">order</td><td>Decoding order </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">freqVector</td><td>Frequency vector; N_bands x 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">itd_s</td><td>Interaural time differences (ITDs), seconds; N_dirs x 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">weights</td><td>Integration weights (set to NULL if not available); N_dirs x 1 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">decMtx</td><td>Decoding matrix; FLAT: N_bands x <a class="el" href="group___utilities.html#ga39b45c9e65aebd2a8ef72c3081baea84" title="2 (true for most humans)">NUM_EARS</a> x (order+1)^2</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>[1] Zaunschirm M, Scho"rkhuber C, Ho"ldrich R. Binaural rendering of Ambisonic signals by head-related impulse response time alignment and a diffuseness constraint. The Journal of the Acoustical Society of America. 2018 Jun 19;143(6):3616&ndash;27 </dd></dl>

<p class="definition">Definition at line <a class="el" href="saf__hoa__internal_8c_source.html#l00432">432</a> of file <a class="el" href="saf__hoa__internal_8c_source.html">saf_hoa_internal.c</a>.</p>

</div>
</div>
<a id="a1688b1a77d8f550c93fb4fc48d23a160" name="a1688b1a77d8f550c93fb4fc48d23a160"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1688b1a77d8f550c93fb4fc48d23a160">&#9670;&#160;</a></span>getEPAD()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getEPAD </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>order</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>ls_dirs_deg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nLS</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>decMtx</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the Energy preserving Ambisonic decoder (EPAD), as detailed in [1]. </p>
<dl class="section note"><dt>Note</dt><dd>The function has been written to also work when the number of spherical harmonic components exceeds the number of loudspeakers. In which case, the 'U' matrix from the SVD is truncated instead. However, ideally, nLS &gt; nSH. </dd>
<dd>
Additional scaling is applied so that when the loudspeakers are uniformly arranged, the decoding matrix gains are equivalent to those produced by SAD/MMD.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">order</td><td>Decoding order </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ls_dirs_deg</td><td>Loudspeaker directions in DEGREES [azi elev]; FLAT: nLS x 2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nLS</td><td>Number of loudspeakers </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">decMtx</td><td>Decoding matrix; FLAT: nLS x (order+1)^2</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>[1] Zotter, F., Pomberger, H., Noisternig, M. (2012). Energy-Preserving Ambisonic Decoding. Acta Acustica United with Acustica, 98(1), 37:47 </dd></dl>

<p class="definition">Definition at line <a class="el" href="saf__hoa__internal_8c_source.html#l00041">41</a> of file <a class="el" href="saf__hoa__internal_8c_source.html">saf_hoa_internal.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_644e041c3a6521da7b27eba0e4eb2b95.html">framework</a></li><li class="navelem"><a class="el" href="dir_56553b6b74e7f4a7717200a52c59b140.html">modules</a></li><li class="navelem"><a class="el" href="dir_99016b584a5af87cdf49f1484dd80da6.html">saf_hoa</a></li><li class="navelem"><a class="el" href="saf__hoa__internal_8c.html">saf_hoa_internal.c</a></li>
    <li class="footer">Generated on Mon Jan 27 2025 08:29:46 for SAF by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
<script type="text/javascript">
  $(function() {
      $(document).ready(function(){
         toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
         toggleButton.title = "Toggle Light/Dark Mode"
         document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
     })
  })
</script>
</body>
</html>
