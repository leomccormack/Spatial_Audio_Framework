<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="google" content="notranslate" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SAF: saf_vbap</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-498Z1C2LX5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-498Z1C2LX5');
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SAF
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('group___v_b_a_p.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">saf_vbap</div></div>
</div><!--header-->
<div class="contents">

<p>Vector-base Amplitude Panning (VBAP) module.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="files" name="files"></a>
Files</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saf__vbap_8c.html">saf_vbap.c</a></td></tr>
<tr class="memdesc:saf__vbap_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Public source for the VBAP/MDAP module (<a class="el" href="saf_8h.html#a7c135beedf7ba9f63cf2f71ca6fad5c6" title="SAF Module: VBAP.">SAF_VBAP_MODULE</a>) <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saf__vbap_8h.html">saf_vbap.h</a></td></tr>
<tr class="memdesc:saf__vbap_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main header for the VBAP/MDAP module (<a class="el" href="saf_8h.html#a7c135beedf7ba9f63cf2f71ca6fad5c6" title="SAF Module: VBAP.">SAF_VBAP_MODULE</a>) <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saf__vbap__internal_8c.html">saf_vbap_internal.c</a></td></tr>
<tr class="memdesc:saf__vbap__internal_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal source for the VBAP/MDAP module (<a class="el" href="saf_8h.html#a7c135beedf7ba9f63cf2f71ca6fad5c6" title="SAF Module: VBAP.">SAF_VBAP_MODULE</a>) <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saf__vbap__internal_8h.html">saf_vbap_internal.h</a></td></tr>
<tr class="memdesc:saf__vbap__internal_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal header for the VBAP/MDAP module (<a class="el" href="saf_8h.html#a7c135beedf7ba9f63cf2f71ca6fad5c6" title="SAF Module: VBAP.">SAF_VBAP_MODULE</a>) <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaa5b0e087cd867a66cf6781570af37403" id="r_gaa5b0e087cd867a66cf6781570af37403"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaa5b0e087cd867a66cf6781570af37403">generateVBAPgainTable3D_srcs</a> (float *src_dirs_deg, int S, float *ls_dirs_deg, int L, int omitLargeTriangles, int enableDummies, float spread, float **gtable, int *N_gtable, int *nTriangles)</td></tr>
<tr class="memdesc:gaa5b0e087cd867a66cf6781570af37403"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a 3-D VBAP [1] gain table based on specified source and loudspeaker directions, with optional spreading [2].  <br /></td></tr>
<tr class="separator:gaa5b0e087cd867a66cf6781570af37403"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa24e445a98791a5bbd9f4ecd3c949249" id="r_gaa24e445a98791a5bbd9f4ecd3c949249"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaa24e445a98791a5bbd9f4ecd3c949249">generateVBAPgainTable3D</a> (float *ls_dirs_deg, int L, int az_res_deg, int el_res_deg, int omitLargeTriangles, int enableDummies, float spread, float **gtable, int *N_gtable, int *nTriangles)</td></tr>
<tr class="memdesc:gaa24e445a98791a5bbd9f4ecd3c949249"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a 3-D VBAP gain table based on specified loudspeaker directions, with optional spreading [2].  <br /></td></tr>
<tr class="separator:gaa24e445a98791a5bbd9f4ecd3c949249"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae06c7d731756572e43b85f249ffb81d5" id="r_gae06c7d731756572e43b85f249ffb81d5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gae06c7d731756572e43b85f249ffb81d5">compressVBAPgainTable3D</a> (float *vbap_gtable, int nTable, int nDirs, float *vbap_gtableComp, int *vbap_gtableIdx)</td></tr>
<tr class="memdesc:gae06c7d731756572e43b85f249ffb81d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compresses a VBAP gain table to use less memory and CPU (by removing the elements which are just zero)  <br /></td></tr>
<tr class="separator:gae06c7d731756572e43b85f249ffb81d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa637de69b5718effebcdb18bef1c3016" id="r_gaa637de69b5718effebcdb18bef1c3016"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaa637de69b5718effebcdb18bef1c3016">VBAPgainTable2InterpTable</a> (float *vbap_gtable, int nTable, int nDirs)</td></tr>
<tr class="memdesc:gaa637de69b5718effebcdb18bef1c3016"><td class="mdescLeft">&#160;</td><td class="mdescRight">Renormalises a VBAP gain table (in-place) so it may be utilised for interpolation of data (for example, powermaps or HRTFs)  <br /></td></tr>
<tr class="separator:gaa637de69b5718effebcdb18bef1c3016"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaa67a9d1c155cf65880cbb4529482321" id="r_gaaa67a9d1c155cf65880cbb4529482321"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaaa67a9d1c155cf65880cbb4529482321">generateVBAPgainTable2D_srcs</a> (float *src_dirs_deg, int S, float *ls_dirs_deg, int L, float **gtable, int *N_gtable, int *nPairs)</td></tr>
<tr class="memdesc:gaaa67a9d1c155cf65880cbb4529482321"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a 2-D VBAP gain table based on specified source and loudspeaker directions.  <br /></td></tr>
<tr class="separator:gaaa67a9d1c155cf65880cbb4529482321"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaee4a2148d03e19ed807a43d147384f3" id="r_gaaee4a2148d03e19ed807a43d147384f3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaaee4a2148d03e19ed807a43d147384f3">generateVBAPgainTable2D</a> (float *ls_dirs_deg, int L, int az_res_deg, float **gtable, int *N_gtable, int *nPairs)</td></tr>
<tr class="memdesc:gaaee4a2148d03e19ed807a43d147384f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a 2-D VBAP gain table based on specified loudspeaker directions.  <br /></td></tr>
<tr class="separator:gaaee4a2148d03e19ed807a43d147384f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf1c8fd2b18c5ca774c606a5b1ebc7928" id="r_gaf1c8fd2b18c5ca774c606a5b1ebc7928"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaf1c8fd2b18c5ca774c606a5b1ebc7928">getPvalues</a> (float DTT, float *freq, int nFreq, float *pValues)</td></tr>
<tr class="memdesc:gaf1c8fd2b18c5ca774c606a5b1ebc7928"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the frequency dependent pValues, which can be applied to ENERGY normalised VBAP gains, to compensate for the room effect on the perceived loudness fluctuations of sources when panning between loudspeakers.  <br /></td></tr>
<tr class="separator:gaf1c8fd2b18c5ca774c606a5b1ebc7928"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2213ebfd6740ad40cf8a6be955258b15" id="r_ga2213ebfd6740ad40cf8a6be955258b15"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga2213ebfd6740ad40cf8a6be955258b15">findLsTriplets</a> (float *ls_dirs_deg, int L, int omitLargeTriangles, float **out_vertices, int *numOutVertices, int **out_faces, int *numOutFaces)</td></tr>
<tr class="memdesc:ga2213ebfd6740ad40cf8a6be955258b15"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the 3D convex-hull of a spherical grid of loudspeaker directions.  <br /></td></tr>
<tr class="separator:ga2213ebfd6740ad40cf8a6be955258b15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4174a71ff53c3fe412364662761592cb" id="r_ga4174a71ff53c3fe412364662761592cb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga4174a71ff53c3fe412364662761592cb">invertLsMtx3D</a> (float *U_spkr, int *ls_groups, int N_group, float **layoutInvMtx)</td></tr>
<tr class="memdesc:ga4174a71ff53c3fe412364662761592cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inverts a 3x3 loudspeaker matrix.  <br /></td></tr>
<tr class="separator:ga4174a71ff53c3fe412364662761592cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga596dc1cf8ebb99e1619877189738cf07" id="r_ga596dc1cf8ebb99e1619877189738cf07"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga596dc1cf8ebb99e1619877189738cf07">getSpreadSrcDirs3D</a> (float src_azi_rad, float src_elev_rad, float spread, int num_src, int num_rings_3d, float *U_spread)</td></tr>
<tr class="memdesc:ga596dc1cf8ebb99e1619877189738cf07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes a set of points which surround the source direction given a specific degree of spread.  <br /></td></tr>
<tr class="separator:ga596dc1cf8ebb99e1619877189738cf07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad7c1c50795736cd9a19223787ea24f75" id="r_gad7c1c50795736cd9a19223787ea24f75"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gad7c1c50795736cd9a19223787ea24f75">vbap3D</a> (float *src_dirs, int src_num, int ls_num, int *ls_groups, int nFaces, float spread, float *layoutInvMtx, float **GainMtx)</td></tr>
<tr class="memdesc:gad7c1c50795736cd9a19223787ea24f75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates 3D VBAP gains given pre-computed loudspeaker triangles for each source direction.  <br /></td></tr>
<tr class="separator:gad7c1c50795736cd9a19223787ea24f75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7504f2e68479b9c1c6f1b860d5562396" id="r_ga7504f2e68479b9c1c6f1b860d5562396"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga7504f2e68479b9c1c6f1b860d5562396">findLsPairs</a> (float *ls_dirs_deg, int L, int **out_pairs, int *numOutPairs)</td></tr>
<tr class="memdesc:ga7504f2e68479b9c1c6f1b860d5562396"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates loudspeaker pairs for a circular grid of loudspeaker directions.  <br /></td></tr>
<tr class="separator:ga7504f2e68479b9c1c6f1b860d5562396"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gade399134c19d24848edc869eedf57e98" id="r_gade399134c19d24848edc869eedf57e98"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gade399134c19d24848edc869eedf57e98">invertLsMtx2D</a> (float *U_spkr, int *ls_pairs, int N_pairs, float **layoutInvMtx)</td></tr>
<tr class="memdesc:gade399134c19d24848edc869eedf57e98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inverts a 2x2 loudspeaker matrix.  <br /></td></tr>
<tr class="separator:gade399134c19d24848edc869eedf57e98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3e5ad1027139a959f74261cce8dfd67c" id="r_ga3e5ad1027139a959f74261cce8dfd67c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga3e5ad1027139a959f74261cce8dfd67c">vbap2D</a> (float *src_dirs, int src_num, int ls_num, int *ls_pairs, int N_pairs, float *layoutInvMtx, float **GainMtx)</td></tr>
<tr class="memdesc:ga3e5ad1027139a959f74261cce8dfd67c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates 2D VBAP gains for pre-calculated loudspeaker pairs and predefined source positions.  <br /></td></tr>
<tr class="separator:ga3e5ad1027139a959f74261cce8dfd67c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Vector-base Amplitude Panning (VBAP) module. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="gae06c7d731756572e43b85f249ffb81d5" name="gae06c7d731756572e43b85f249ffb81d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae06c7d731756572e43b85f249ffb81d5">&#9670;&#160;</a></span>compressVBAPgainTable3D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compressVBAPgainTable3D </td>
          <td>(</td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>vbap_gtable</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nTable</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nDirs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>vbap_gtableComp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>vbap_gtableIdx</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compresses a VBAP gain table to use less memory and CPU (by removing the elements which are just zero) </p>
<p>Handy for large grid sizes for interpolation purposes. Therefore, the gains are also re-normalised to have the AMPLITUDE-preserving property. If vbap_gtable is generated by <a class="el" href="#gaa24e445a98791a5bbd9f4ecd3c949249" title="Generates a 3-D VBAP gain table based on specified loudspeaker directions, with optional spreading [2...">generateVBAPgainTable3D()</a>, then the compressed tables should be accessed as: </p><div class="fragment"><div class="line">N_azi = (int)(360.0f / aziRes + 0.5f) + 1;</div>
<div class="line">aziIndex = (int)(<a class="code hl_function" href="group___utilities.html#ga3b9806b290b960cd718bac53080235ae">matlab_fmodf</a>(AZI + 180.0f, 360.0f)/az_res_deg + 0.5f);</div>
<div class="line">elevIndex = (int)((ELEV + 90.0f) / el_res_deg + 0.5f);</div>
<div class="line">idx3d = elevIndex * N_azi + aziIndex;</div>
<div class="line"><span class="keywordflow">for</span> (i = 0; i &lt; 3; i++){</div>
<div class="line">    gains[i] =  vbap_gtableComp[idx3d*3+i];</div>
<div class="line">    idx[i]   =  vbap_gtableIdx[idx3d*3+i];</div>
<div class="line">}</div>
<div class="ttc" id="agroup___utilities_html_ga3b9806b290b960cd718bac53080235ae"><div class="ttname"><a href="group___utilities.html#ga3b9806b290b960cd718bac53080235ae">matlab_fmodf</a></div><div class="ttdeci">float matlab_fmodf(float x, float y)</div><div class="ttdoc">C fmodf function, except it behaves like &#39;mod&#39; in Matlab (i.e.</div><div class="ttdef"><b>Definition</b> <a href="saf__utility__misc_8c_source.html#l00190">saf_utility_misc.c:190</a></div></div>
</div><!-- fragment --><p>where 'gains' are then the gains for loudspeakers('idx') to pan the source to [AZI ELEV], using the nearest grid point</p>
<dl class="section note"><dt>Note</dt><dd>The VBAP gains are AMPLITUDE normalised; i.e. sum(gains) = 1</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vbap_gtable</td><td>The 3D VBAP gain table; FLAT: nTable x nDirs </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nTable</td><td>number of points in the gain table </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nDirs</td><td>number of loudspeakers </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vbap_gtableComp</td><td>The compressed 3D VBAP gain table amplitude- normalised; FLAT: nTable x 3 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vbap_gtableIdx</td><td>The indices for the compressed 3D VBAP gain table; FLAT: nTable x 3 </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="saf__vbap_8c_source.html#l00312">312</a> of file <a class="el" href="saf__vbap_8c_source.html">saf_vbap.c</a>.</p>

</div>
</div>
<a id="ga7504f2e68479b9c1c6f1b860d5562396" name="ga7504f2e68479b9c1c6f1b860d5562396"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7504f2e68479b9c1c6f1b860d5562396">&#9670;&#160;</a></span>findLsPairs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void findLsPairs </td>
          <td>(</td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>ls_dirs_deg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>L</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **</td>          <td class="paramname"><span class="paramname"><em>out_pairs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>numOutPairs</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates loudspeaker pairs for a circular grid of loudspeaker directions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ls_dirs_deg</td><td>Loudspeaker directions in degrees; FLAT: L x 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">L</td><td>Number of loudspeakers </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out_pairs</td><td>(&amp;) loudspeaker pair indices; FLAT: numOutPairs x 2 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">numOutPairs</td><td>(&amp;) number of loudspeaker pairs </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="saf__vbap_8c_source.html#l00898">898</a> of file <a class="el" href="saf__vbap_8c_source.html">saf_vbap.c</a>.</p>

</div>
</div>
<a id="ga2213ebfd6740ad40cf8a6be955258b15" name="ga2213ebfd6740ad40cf8a6be955258b15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2213ebfd6740ad40cf8a6be955258b15">&#9670;&#160;</a></span>findLsTriplets()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void findLsTriplets </td>
          <td>(</td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>ls_dirs_deg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>L</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>omitLargeTriangles</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **</td>          <td class="paramname"><span class="paramname"><em>out_vertices</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>numOutVertices</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **</td>          <td class="paramname"><span class="paramname"><em>out_faces</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>numOutFaces</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the 3D convex-hull of a spherical grid of loudspeaker directions. </p>
<dl class="section note"><dt>Note</dt><dd>Compared with <a class="el" href="group___utilities.html#gab81aab7da3deb5671c4cde3448855543" title="Delaunay triangulation of a spherical arrangement of points.">sphDelaunay()</a>, this function also omits triangles where the normals and the centroid to the triangles have an angle larger than pi/2. Trianges which have an aperture larger than <a class="el" href="saf__vbap__internal_8h.html#a8b7f3416f1666baa30c7e189b7ecb807" title="if omitLargeTriangles==1, triangles with an aperture larger than this are discarded">APERTURE_LIMIT_DEG</a> are also ommited.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ls_dirs_deg</td><td>Loudspeaker directions in degrees; FLAT: L x 2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">L</td><td>Number of loudspeakers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">omitLargeTriangles</td><td>'0' normal triangulation, '1' remove large triangles </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out_vertices</td><td>(&amp;) loudspeaker directions in cartesian coordinates; FLAT: L x 3 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">numOutVertices</td><td>(&amp;) number of loudspeakers </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out_faces</td><td>(&amp;) loudspeaker triangle indices; FLAT: numOutFaces x 3 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">numOutFaces</td><td>(&amp;) number of true loudspeaker triangles </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="saf__vbap_8c_source.html#l00499">499</a> of file <a class="el" href="saf__vbap_8c_source.html">saf_vbap.c</a>.</p>

</div>
</div>
<a id="gaaee4a2148d03e19ed807a43d147384f3" name="gaaee4a2148d03e19ed807a43d147384f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaee4a2148d03e19ed807a43d147384f3">&#9670;&#160;</a></span>generateVBAPgainTable2D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void generateVBAPgainTable2D </td>
          <td>(</td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>ls_dirs_deg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>L</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>az_res_deg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **</td>          <td class="paramname"><span class="paramname"><em>gtable</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>N_gtable</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>nPairs</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a 2-D VBAP gain table based on specified loudspeaker directions. </p>
<p>This function generates the VBAP gains for a grid: -180:az_res_deg:180 azimuths, which should be accessed as: </p><div class="fragment"><div class="line">aziIndex = (int)(<a class="code hl_function" href="group___utilities.html#ga3b9806b290b960cd718bac53080235ae">matlab_fmodf</a>(AZI + 180.0f, 360.0f)/az_res_deg + 0.5f);</div>
<div class="line">idx2d = aziIndex;</div>
<div class="line"><span class="keywordflow">for</span> (ls = 0; ls &lt; L; ls++){</div>
<div class="line">    gains2D[ls] =  gtable[idx2d*L+ls];}</div>
</div><!-- fragment --><p>'gains2D' are then the loudspeaker gains to pan the source to [AZI 0], using the nearest grid point.</p>
<dl class="section note"><dt>Note</dt><dd>The VBAP gains are ENERGY normalised; i.e. sum(gains^2) = 1</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ls_dirs_deg</td><td>Loudspeaker directions in degrees (elev assumed to be 0 for all); FLAT: L x 2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">L</td><td>Number of loudspeakers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">az_res_deg</td><td>Azimuthal resolution in degrees </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">gtable</td><td>(&amp;) The 2D VBAP gain table energy normalised; FLAT: S x L </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">N_gtable</td><td>(&amp;) number of points in the gain table, N_gtable=S </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nPairs</td><td>(&amp;) number of loudspeaker pairs </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="saf__vbap_8c_source.html#l00428">428</a> of file <a class="el" href="saf__vbap_8c_source.html">saf_vbap.c</a>.</p>

</div>
</div>
<a id="gaaa67a9d1c155cf65880cbb4529482321" name="gaaa67a9d1c155cf65880cbb4529482321"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaa67a9d1c155cf65880cbb4529482321">&#9670;&#160;</a></span>generateVBAPgainTable2D_srcs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void generateVBAPgainTable2D_srcs </td>
          <td>(</td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>src_dirs_deg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>S</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>ls_dirs_deg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>L</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **</td>          <td class="paramname"><span class="paramname"><em>gtable</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>N_gtable</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>nPairs</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a 2-D VBAP gain table based on specified source and loudspeaker directions. </p>
<dl class="section note"><dt>Note</dt><dd>source and loudspeaker directions are required to be inter-leaved with zeros, i.e. [src_az1, 0; src_az2, 0; src_az3, 0;]. The VBAP gains are also ENERGY normalised; i.e. sum(gains^2) = 1</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">src_dirs_deg</td><td>Source directions in degrees (elev assumed to be 0 for all); FLAT: S x 2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">S</td><td>Number of Sources </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ls_dirs_deg</td><td>Loudspeaker directions in degrees (elev assumed to be 0 for all); FLAT: L x 2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">L</td><td>Number of loudspeakers </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">gtable</td><td>(&amp;) The 2D VBAP gain table energy normalised; FLAT: S x L </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">N_gtable</td><td>(&amp;) number of points in the gain table, N_gtable=S </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nPairs</td><td>(&amp;) number of loudspeaker pairs </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="saf__vbap_8c_source.html#l00390">390</a> of file <a class="el" href="saf__vbap_8c_source.html">saf_vbap.c</a>.</p>

</div>
</div>
<a id="gaa24e445a98791a5bbd9f4ecd3c949249" name="gaa24e445a98791a5bbd9f4ecd3c949249"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa24e445a98791a5bbd9f4ecd3c949249">&#9670;&#160;</a></span>generateVBAPgainTable3D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void generateVBAPgainTable3D </td>
          <td>(</td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>ls_dirs_deg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>L</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>az_res_deg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>el_res_deg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>omitLargeTriangles</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>enableDummies</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>spread</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **</td>          <td class="paramname"><span class="paramname"><em>gtable</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>N_gtable</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>nTriangles</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a 3-D VBAP gain table based on specified loudspeaker directions, with optional spreading [2]. </p>
<p>This function generates the VBAP gains for a grid: -180:az_res_deg:180 azimuths and -90:el_res_deg:90 elevations, which should be accessed as: </p><div class="fragment"><div class="line">N_azi = (int)(360.0f / aziRes + 0.5f) + 1;</div>
<div class="line">aziIndex = (int)(<a class="code hl_function" href="group___utilities.html#ga3b9806b290b960cd718bac53080235ae">matlab_fmodf</a>(AZI + 180.0f, 360.0f)/az_res_deg + 0.5f);</div>
<div class="line">elevIndex = (int)((ELEV + 90.0f) / el_res_deg + 0.5f);</div>
<div class="line">idx3d = elevIndex * N_azi + aziIndex;</div>
<div class="line"><span class="keywordflow">for</span> (ls = 0; ls &lt; L; ls++)</div>
<div class="line">    gains3D[ls] =  gtable[idx3d*L+ls];}</div>
</div><!-- fragment --><p>where 'gains3D' are the loudspeaker gains to pan the source to [AZI ELEV], using the nearest grid point</p>
<dl class="section note"><dt>Note</dt><dd>'gtable' is returned as NULL if the triangulation fails. The VBAP gains are also ENERGY normalised; i.e. sum(gains^2) = 1</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ls_dirs_deg</td><td>Loudspeaker directions in degrees; FLAT: L x 2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">L</td><td>Number of loudspeakers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">az_res_deg</td><td>Azimuthal resolution in degrees </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">el_res_deg</td><td>Elevation resolution in degrees </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">omitLargeTriangles</td><td>'0' normal triangulation, '1' remove large triangles </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">enableDummies</td><td>'0' disabled, '1' enabled. Dummies are placed at +/-90 elevation if required </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">spread</td><td>Spreading factor in degrees, 0: VBAP, &gt;0: MDAP </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">gtable</td><td>(&amp;) The 3D VBAP gain table ENERGY normalised; FLAT: N_gtable x L </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">N_gtable</td><td>(&amp;) number of points in the gain table </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nTriangles</td><td>(&amp;) number of loudspeaker triangles</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>[1] Pulkki, V. (1997). Virtual sound source positioning using vector base amplitude panning. Journal of the audio engineering society, 45(6), 456-466. </dd>
<dd>
[2] Pulkki, V. (1999). Uniform spreading of amplitude panned virtual sources. In Proceedings of the 1999 IEEE Workshop on Applications of Signal Processing to Audio and Acoustics. WASPAA'99 (Cat. No. 99TH8452) (pp. 187-190). IEEE. </dd></dl>

<p class="definition">Definition at line <a class="el" href="saf__vbap_8c_source.html#l00171">171</a> of file <a class="el" href="saf__vbap_8c_source.html">saf_vbap.c</a>.</p>

</div>
</div>
<a id="gaa5b0e087cd867a66cf6781570af37403" name="gaa5b0e087cd867a66cf6781570af37403"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa5b0e087cd867a66cf6781570af37403">&#9670;&#160;</a></span>generateVBAPgainTable3D_srcs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void generateVBAPgainTable3D_srcs </td>
          <td>(</td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>src_dirs_deg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>S</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>ls_dirs_deg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>L</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>omitLargeTriangles</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>enableDummies</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>spread</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **</td>          <td class="paramname"><span class="paramname"><em>gtable</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>N_gtable</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>nTriangles</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a 3-D VBAP [1] gain table based on specified source and loudspeaker directions, with optional spreading [2]. </p>
<dl class="section note"><dt>Note</dt><dd>gtable is returned as NULL if the triangulation fails. The VBAP gains are also ENERGY normalised; i.e. sum(gains^2) = 1</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">src_dirs_deg</td><td>Source directions in degrees; FLAT: S x 2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">S</td><td>Number of Sources </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ls_dirs_deg</td><td>Loudspeaker directions in degrees; FLAT: L x 2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">L</td><td>Number of loudspeakers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">omitLargeTriangles</td><td>'0' normal triangulation, '1' remove large triangles </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">enableDummies</td><td>'0' disabled, '1' enabled, and dummies are placed at +/-90 elevation if required </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">spread</td><td>Spreading factor in degrees, 0: VBAP, &gt;0: MDAP </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">gtable</td><td>(&amp;) The 3D VBAP gain table energy normalised; FLAT: N_gtable x L </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">N_gtable</td><td>(&amp;) number of points in the gain table </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nTriangles</td><td>(&amp;) number of loudspeaker triangles</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>[1] Pulkki, V. (1997). Virtual sound source positioning using vector base amplitude panning. Journal of the audio engineering society, 45(6), 456-466. </dd>
<dd>
[2] Pulkki, V. (1999). Uniform spreading of amplitude panned virtual sources. In Proceedings of the 1999 IEEE Workshop on Applications of Signal Processing to Audio and Acoustics. WASPAA'99 (Cat. No. 99TH8452) (pp. 187-190). IEEE. </dd></dl>

<p class="definition">Definition at line <a class="el" href="saf__vbap_8c_source.html#l00052">52</a> of file <a class="el" href="saf__vbap_8c_source.html">saf_vbap.c</a>.</p>

</div>
</div>
<a id="gaf1c8fd2b18c5ca774c606a5b1ebc7928" name="gaf1c8fd2b18c5ca774c606a5b1ebc7928"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf1c8fd2b18c5ca774c606a5b1ebc7928">&#9670;&#160;</a></span>getPvalues()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getPvalues </td>
          <td>(</td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>DTT</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>freq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nFreq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>pValues</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the frequency dependent pValues, which can be applied to ENERGY normalised VBAP gains, to compensate for the room effect on the perceived loudness fluctuations of sources when panning between loudspeakers. </p>
<p>This should be applied as: </p><div class="fragment"><div class="line"><span class="keywordflow">if</span>(pValues[band] != 2.0f){</div>
<div class="line">   gains3D_sum_pvf = 0.0f;</div>
<div class="line">   <span class="keywordflow">for</span> (i = 0; i &lt; nLoudspeakers; i++){</div>
<div class="line">       gains3D_sum_pvf += powf(MAX(gains[i], 0.0f), pValues[band]);}</div>
<div class="line">   gains3D_sum_pvf = powf(gains3D_sum_pvf, 1.0f/(pValues[band]+2.23e-13f));</div>
<div class="line">   <span class="keywordflow">for</span> (i = 0; i &lt; nLoudspeakers; i++){</div>
<div class="line">       gains_p[i] = gains[i] / (gains3D_sum_pvf+2.23e-13f);}</div>
<div class="line">}</div>
</div><!-- fragment --><p>Where "gains" are the original energy normalised VBAP gains and "gains_p" have amplitude normalisation for the low frequencies, and energy normalisation at the high frequencies [1].</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">DTT</td><td>0..1 '0': for normal room, '1' for anechoic room, '0.5' for listening room </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">freq</td><td>Frequency vector in Hz; nFreq x 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nFreq</td><td>Number of frequencies in the frequency vector </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pValues</td><td>pValues for each frequency; nFreq x 1</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>[1] Laitinen, M., Vilkamo, J., Jussila, K., Politis, A., Pulkki, V. (2014). Gain normalisation in amplitude panning as a function of frequency and room reverberance. 55th International Conference of the AES. Helsinki, Finland. </dd></dl>

<p class="definition">Definition at line <a class="el" href="saf__vbap_8c_source.html#l00475">475</a> of file <a class="el" href="saf__vbap_8c_source.html">saf_vbap.c</a>.</p>

</div>
</div>
<a id="ga596dc1cf8ebb99e1619877189738cf07" name="ga596dc1cf8ebb99e1619877189738cf07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga596dc1cf8ebb99e1619877189738cf07">&#9670;&#160;</a></span>getSpreadSrcDirs3D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getSpreadSrcDirs3D </td>
          <td>(</td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>src_azi_rad</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>src_elev_rad</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>spread</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>num_src</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>num_rings_3d</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>U_spread</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes a set of points which surround the source direction given a specific degree of spread. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">src_azi_rad</td><td>Source azimuth, in radians </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">src_elev_rad</td><td>Source elevation, in radians </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">spread</td><td>Spread in DEGREES </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">num_src</td><td>Number of auxiliary sources to use for spreading </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">num_rings_3d</td><td>Number of concentric rings of num_src each to generate inside the spreading surface </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">U_spread</td><td>Spread directions Cartesian coordinates; FLAT: (num_src*num_rings_3d+1) x 3 </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="saf__vbap_8c_source.html#l00707">707</a> of file <a class="el" href="saf__vbap_8c_source.html">saf_vbap.c</a>.</p>

</div>
</div>
<a id="gade399134c19d24848edc869eedf57e98" name="gade399134c19d24848edc869eedf57e98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gade399134c19d24848edc869eedf57e98">&#9670;&#160;</a></span>invertLsMtx2D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void invertLsMtx2D </td>
          <td>(</td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>U_spkr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>ls_pairs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>N_pairs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **</td>          <td class="paramname"><span class="paramname"><em>layoutInvMtx</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inverts a 2x2 loudspeaker matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">U_spkr</td><td>Loudspeaker directions in cartesian (xy) coordinates; FLAT: L x 2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ls_pairs</td><td>Loudspeaker pair indices; FLAT: N_pairs x 3 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N_pairs</td><td>Number of loudspeaker pairs </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">layoutInvMtx</td><td>(&amp;) inverted 2x2 loudspeaker matrix flattened; FLAT: N_group x 4 </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="saf__vbap_8c_source.html#l00930">930</a> of file <a class="el" href="saf__vbap_8c_source.html">saf_vbap.c</a>.</p>

</div>
</div>
<a id="ga4174a71ff53c3fe412364662761592cb" name="ga4174a71ff53c3fe412364662761592cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4174a71ff53c3fe412364662761592cb">&#9670;&#160;</a></span>invertLsMtx3D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void invertLsMtx3D </td>
          <td>(</td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>U_spkr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>ls_groups</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>N_group</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **</td>          <td class="paramname"><span class="paramname"><em>layoutInvMtx</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inverts a 3x3 loudspeaker matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">U_spkr</td><td>Loudspeaker directions as cartesian coordinates (unit length); FLAT: L x 3 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ls_groups</td><td>True loudspeaker triangle indices; FLAT: N_group x 3 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N_group</td><td>Number of true loudspeaker triangles </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">layoutInvMtx</td><td>(&amp;) inverted 3x3 loudspeaker matrices per group; FLAT: N_group x 9 </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="saf__vbap_8c_source.html#l00676">676</a> of file <a class="el" href="saf__vbap_8c_source.html">saf_vbap.c</a>.</p>

</div>
</div>
<a id="ga3e5ad1027139a959f74261cce8dfd67c" name="ga3e5ad1027139a959f74261cce8dfd67c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3e5ad1027139a959f74261cce8dfd67c">&#9670;&#160;</a></span>vbap2D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vbap2D </td>
          <td>(</td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>src_dirs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>src_num</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>ls_num</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>ls_pairs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>N_pairs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>layoutInvMtx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **</td>          <td class="paramname"><span class="paramname"><em>GainMtx</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates 2D VBAP gains for pre-calculated loudspeaker pairs and predefined source positions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">src_dirs</td><td>Source directions in degrees; FLAT: src_num x 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">src_num</td><td>Number of sources </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ls_num</td><td>Number of loudspeakers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ls_pairs</td><td>Loudspeaker pair indices; FLAT: N_pairs x 2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N_pairs</td><td>Number of loudspeaker pairs </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">layoutInvMtx</td><td>Inverted 2x2 loudspeaker matrix flattened; FLAT: N_pairs x 4 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">GainMtx</td><td>(&amp;) Loudspeaker VBAP gain table; FLAT: src_num x ls_num </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="saf__vbap_8c_source.html#l00962">962</a> of file <a class="el" href="saf__vbap_8c_source.html">saf_vbap.c</a>.</p>

</div>
</div>
<a id="gad7c1c50795736cd9a19223787ea24f75" name="gad7c1c50795736cd9a19223787ea24f75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad7c1c50795736cd9a19223787ea24f75">&#9670;&#160;</a></span>vbap3D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vbap3D </td>
          <td>(</td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>src_dirs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>src_num</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>ls_num</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>ls_groups</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nFaces</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>spread</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>layoutInvMtx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **</td>          <td class="paramname"><span class="paramname"><em>GainMtx</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates 3D VBAP gains given pre-computed loudspeaker triangles for each source direction. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">src_dirs</td><td>Source directions in degrees; FLAT: src_num x 2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">src_num</td><td>Number of sources </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ls_num</td><td>Number of loudspeakers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ls_groups</td><td>Loudspeaker triangle indices, see <a class="el" href="#ga2213ebfd6740ad40cf8a6be955258b15" title="Computes the 3D convex-hull of a spherical grid of loudspeaker directions.">findLsTriplets()</a>; FLAT: nFaces x 3 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nFaces</td><td>Number of true loudspeaker triangles </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">spread</td><td>Spreading in degrees, 0: VBAP, &gt;0: MDAP </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">layoutInvMtx</td><td>Inverted 3x3 loudspeaker matrix flattened, see <a class="el" href="#ga4174a71ff53c3fe412364662761592cb" title="Inverts a 3x3 loudspeaker matrix.">invertLsMtx3D()</a>; FLAT: nFaces x 9 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">GainMtx</td><td>(&amp;) Loudspeaker VBAP gain table; FLAT: src_num x ls_num </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="saf__vbap_8c_source.html#l00786">786</a> of file <a class="el" href="saf__vbap_8c_source.html">saf_vbap.c</a>.</p>

</div>
</div>
<a id="gaa637de69b5718effebcdb18bef1c3016" name="gaa637de69b5718effebcdb18bef1c3016"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa637de69b5718effebcdb18bef1c3016">&#9670;&#160;</a></span>VBAPgainTable2InterpTable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VBAPgainTable2InterpTable </td>
          <td>(</td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>vbap_gtable</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nTable</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nDirs</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Renormalises a VBAP gain table (in-place) so it may be utilised for interpolation of data (for example, powermaps or HRTFs) </p>
<dl class="section note"><dt>Note</dt><dd>The VBAP gains are AMPLITUDE normalised; i.e. sum(gains) = 1.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">vbap_gtable</td><td>The 3D VBAP gain table; FLAT: nTable x nDirs </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nTable</td><td>Number of points in the gain table </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nDirs</td><td>Number of loudspeaker directions </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="saf__vbap_8c_source.html#l00369">369</a> of file <a class="el" href="saf__vbap_8c_source.html">saf_vbap.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Jan 27 2025 08:29:46 for SAF by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
<script type="text/javascript">
  $(function() {
      $(document).ready(function(){
         toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
         toggleButton.title = "Toggle Light/Dark Mode"
         document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
     })
  })
</script>
</body>
</html>
