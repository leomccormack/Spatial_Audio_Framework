<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="google" content="notranslate" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SAF: SAF</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-498Z1C2LX5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-498Z1C2LX5');
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SAF
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">SAF </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="anchor" id="md_README"></a> <img src="https://img.shields.io/github/v/release/leomccormack/Spatial_Audio_Framework" alt="GitHub release (latest by date)" class="inline"/> <img src="https://img.shields.io/github/release-date/leomccormack/Spatial_Audio_Framework" alt="GitHub Release Date" class="inline"/> <a href="https://doi.org/10.5281/zenodo.4118286"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.4707945.svg" alt="DOI" style="pointer-events: none;" class="inline"/></a> <br  />
</p>
<p ><img src="saf.svg" alt="" style="pointer-events: none;" class="inline"/></p>
<ul>
<li>git: <a href="https://github.com/leomccormack/Spatial_Audio_Framework">https://github.com/leomccormack/Spatial_Audio_Framework</a></li>
<li>doxygen: <a href="https://leomccormack.github.io/Spatial_Audio_Framework/">https://leomccormack.github.io/Spatial_Audio_Framework/</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md95"></a>
About</h1>
<p >The Spatial_Audio_Framework (SAF) is an open-source and cross-platform framework for developing spatial audio related algorithms and software in C/C++. While originally intended as a resource for researchers in the field, the framework has gradually grown into a rather large codebase comprising a number of distinct <a href="framework/modules"><b>modules</b></a>; with each module targeting a specific sub-field of spatial audio (e.g. Ambisonics encoding/decoding, spherical array processing, amplitude-panning, HRIR processing, room simulation, etc.). The framework also makes use of highly optimised linear algebra libraries (such as Intel MKL, Apple Accelerate, OpenBLAS) as well as SIMD intrinsics (SSE, AVX, AVX-512). Several <a href="examples/include"><b>examples</b></a> are also included in the repository, which serve to demonstrate the functionality of the framework and may also act as a starting point for new projects.</p>
<p >Owing to its modular design, expanding the framework is relatively straightforward, and contributions from researchers and developers of spatial audio technologies is actively encouraged! :-)</p>
<h1><a class="anchor" id="autotoc_md96"></a>
Prerequisites</h1>
<p >The framework requires the following external libraries:</p><ul>
<li>Any library (or libraries) conforming to the <a href="https://en.wikipedia.org/wiki/Basic_Linear_Algebra_Subprograms#Implementations">CBLAS</a> and <a href="https://en.wikipedia.org/wiki/LAPACK">LAPACK</a> standards</li>
<li>(<b>Optional</b>) Intel's <a href="https://software.intel.com/content/www/us/en/develop/tools/integrated-performance-primitives.html">Integrated Performance Primitives (IPP)</a> for the FFT and/or resampler</li>
<li>(<b>Optional</b>) <a href="https://www.fftw.org/">FFTW</a> for the FFT</li>
<li>(<b>Optional</b>) a SSE, AVX, AVX-512 supporting CPU</li>
</ul>
<p >In order to inform SAF which CBLAS/LAPACK supporting library/libraries you have linked to your project, simply add <b>one</b> of the following global pre-processor definitions: </p><div class="fragment"><div class="line">SAF_USE_INTEL_MKL_LP64        # great option, but only for x86 architectures (using the LP64 config [int32])</div>
<div class="line">SAF_USE_INTEL_MKL_ILP64       # great option, but only for x86 architectures (using the ILP64 config [int64])</div>
<div class="line">SAF_USE_OPEN_BLAS_AND_LAPACKE # good option, works on everything</div>
<div class="line">SAF_USE_APPLE_ACCELERATE      # good option (x86 and ARM), faster than OpenBLAS, but MacOSX only &amp; slower than MKL</div>
<div class="line">SAF_USE_ATLAS                 # bad option (x86 and ARM), many LAPACK functions are missing</div>
<div class="line">SAF_USE...                    # please get in touch if you use something else! :-)</div>
</div><!-- fragment --><p> <a class="el" href="md_docs__p_e_r_f_o_r_m_a_n_c_e__l_i_b_r_a_r_y__i_n_s_t_r_u_c_t_i_o_n_s.html">Detailed instructions regarding how to build and link these libraries can be found here</a>.</p>
<h2><a class="anchor" id="autotoc_md97"></a>
Framework structure</h2>
<p >The <a class="el" href="md_docs__f_r_a_m_e_w_o_r_k__s_t_r_u_c_t_u_r_e.html">framework</a> comprises the following core modules (<b>ISC</b> License):</p><ul>
<li><b>saf_hoa</b> - a collection of higher-order Ambisonics binaural and loudspeaker decoders.</li>
<li><b>saf_sh</b> - spherical harmonic and spherical array processing related functions.</li>
<li><b>saf_vbap</b> - Vector-base Amplitude Panning (VBAP) functions.</li>
<li><b>saf_cdf4sap</b> - Covariance Domain Framework for Spatial Audio Processing (CDF4SAP).</li>
<li><b>saf_hrir</b> - HRIR/HRTF related functions (estimating ITDs, HRTF interpolation, diffuse-field EQ etc.).</li>
<li><b>saf_reverb</b> - a collection of reverbs and room simulation algorithms.</li>
<li><b>saf_utilities</b> - a collection of useful utility functions and cross-platform wrappers.</li>
</ul>
<p >The framework also includes the following optional modules:</p><ul>
<li><b>saf_sofa_reader</b> - a simple SOFA file reader (<b>ISC</b> License).</li>
<li><b>saf_tracker</b> - a particle-filtering based tracker (<b>GPLv2</b> License).</li>
<li><b>saf_hades</b> - for binaural rendering of Hearing-Assistive/Augmented-reality Devices (HADES) (<b>GPLv2</b> License).</li>
</ul>
<p >To enable optional framework modules, simply add the relevant pre-processor definition: </p><div class="fragment"><div class="line">SAF_ENABLE_SOFA_READER_MODULE  # to enable saf_sofa_reader</div>
<div class="line">SAF_ENABLE_TRACKER_MODULE      # to enable saf_tracker</div>
<div class="line">SAF_ENABLE_HADES_MODULE        # to enable saf_hades</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md98"></a>
Additional options</h3>
<p >The framework can be configured further, with the following options: </p><div class="fragment"><div class="line">SAF_USE_INTEL_IPP # To use Intel IPP for performing the DFT/FFT and resampling</div>
<div class="line">SAF_USE_FFTW      # To use the FFTW library for performing the DFT/FFT </div>
<div class="line">SAF_ENABLE_SIMD   # To enable SIMD (SSE, AVX, AVX512) intrinsics for certain vector operations</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md99"></a>
Using the framework</h1>
<p >Once a CBLAS/LAPACK flag is defined (and the correct libraries are linked to your project), add the files found in the <b>framework</b> folder to your project and add the following directory to your project's header search paths:</p>
<div class="fragment"><div class="line">Spatial_Audio_Framework/framework/include  </div>
</div><!-- fragment --><p >The framework's master include header is then:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="saf_8h.html">saf.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="saf__externals_8h.html">saf_externals.h</a>&quot;</span>  <span class="comment">/* (Optional) To also carry over CBLAS/LAPACK routines and other external functions. */</span></div>
<div class="ttc" id="asaf_8h_html"><div class="ttname"><a href="saf_8h.html">saf.h</a></div><div class="ttdoc">Main include header for the Spatial_Audio_Framework (SAF)</div></div>
<div class="ttc" id="asaf__externals_8h_html"><div class="ttname"><a href="saf__externals_8h.html">saf_externals.h</a></div><div class="ttdoc">Include header for SAF externals.</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md100"></a>
Building with CMake</h2>
<p ><img src="https://github.com/leomccormack/Spatial_Audio_Framework/workflows/CMake%20Build/badge.svg?branch=master" alt="CMake Build" style="pointer-events: none;" class="inline"/></p>
<p >The framework may also be included within an existing CMake workflow with simply: </p><div class="fragment"><div class="line">add_subdirectory(Spatial_Audio_Framework)</div>
<div class="line">target_link_libraries(${PROJECT_NAME} PRIVATE saf)</div>
</div><!-- fragment --><p >The available SAF-related CMake options (and their default values) are: </p><div class="fragment"><div class="line">-DSAF_PERFORMANCE_LIB=SAF_USE_INTEL_MKL_LP64 # performance library to employ</div>
<div class="line">-DSAF_ENABLE_SOFA_READER_MODULE=0            # enable/disable the saf_sofa_reader module </div>
<div class="line">-DSAF_ENABLE_TRACKER_MODULE=0                # enable/disable the saf_tracker module </div>
<div class="line">-DSAF_ENABLE_HADES_MODULE=0                  # enable/disable the saf_hades module </div>
<div class="line">-DSAF_BUILD_EXAMPLES=1                       # build saf examples</div>
<div class="line">-DSAF_BUILD_EXTRAS=0                         # build safmex etc.</div>
<div class="line">-DSAF_BUILD_TESTS=1                          # build unit testing program</div>
<div class="line">-DSAF_USE_INTEL_IPP=0                        # link and use Intel IPP for the FFT, resampler, etc.</div>
<div class="line">-DSAF_ENABLE_SIMD=0                          # enable/disable SSE, AVX, and/or AVX-512 support</div>
<div class="line">-DSAF_USE_FAST_MATH_FLAG=1                   # enable the -ffast-math compiler flag on clang/gcc</div>
</div><!-- fragment --><p >If using e.g. <b>SAF_USE_INTEL_MKL_LP64</b> as the performance library, note that the default header and library search paths may be overridden <a class="el" href="md_docs__p_e_r_f_o_r_m_a_n_c_e__l_i_b_r_a_r_y__i_n_s_t_r_u_c_t_i_o_n_s.html">according to your setup</a> with: </p><div class="fragment"><div class="line">-DINTEL_MKL_HEADER_PATH=&quot;path/to/mkl/headers&quot;</div>
<div class="line">-DINTEL_MKL_LIB=&quot;path/to/mkl/libs/mkl_rt(.so/.dylib/.lib)&quot;   # OR:</div>
<div class="line">-DINTEL_MKL_LIB=&quot;path/to/custom/mkl/lib/saf_mkl_custom_lp64(.so/.dylib/.lib)&quot;</div>
</div><!-- fragment --><p >For Linux/MacOS users: the framework, examples, and unit testing program may be built as follows: </p><div class="fragment"><div class="line">cmake -S . -B build </div>
<div class="line"># Or to also enable e.g. SSE3 and AVX2 intrinsics (for both C and C++ code)</div>
<div class="line">cmake -S . -B build -DSAF_ENABLE_SIMD=1 -DCMAKE_CXX_FLAGS=&quot;-msse3 -mavx2&quot; -DCMAKE_C_FLAGS=&quot;-msse3 -mavx2&quot;</div>
<div class="line">cd build</div>
<div class="line">make</div>
<div class="line">test/saf_test # To run the unit testing program</div>
</div><!-- fragment --><p >Or for Visual Studio users (using x64 Native Tools Command Prompt for VS): </p><div class="fragment"><div class="line"># e.g. for VS2019:</div>
<div class="line">cmake -S . -B build -G &quot;Visual Studio 16&quot; -A x64  </div>
<div class="line"># e.g. for VS2017:</div>
<div class="line">cmake -S . -B build -G &quot;Visual Studio 15 Win64&quot;</div>
<div class="line">cd build</div>
<div class="line">msbuild ALL_BUILD.vcxproj /p:Configuration=Release /m</div>
<div class="line">cd test/Release</div>
<div class="line">saf_test.exe  # To run the unit testing program</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md101"></a>
Documentation</h2>
<p ><img src="https://github.com/leomccormack/Spatial_Audio_Framework/workflows/Doxygen%20Generate/badge.svg?branch=master" alt="Doxygen Generate" style="pointer-events: none;" class="inline"/></p>
<p ><a href="http://www.doxygen.nl/index.html">Doxygen</a>-based documentation is generated via a GitHub Action everytime a commit is pushed to the master branch. The documentation is hosted <a href="https://leomccormack.github.io/Spatial_Audio_Framework/">here</a>.</p>
<p >Alternatively, you may generate the documentation yourself (e.g. for the other branches) with the following commands: </p><div class="fragment"><div class="line">cd docs/doxygen</div>
<div class="line">doxygen doxygen_config</div>
<div class="line"># (optional) to also build the pdf version:</div>
<div class="line">cd latex</div>
<div class="line">make</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md102"></a>
Examples</h2>
<p >Several <b>examples</b> have also been included in the repository, which may serve as a starting point for learning how to use the framework:</p>
<ul>
<li><b>ambi_bin</b> - a binaural Ambisonic decoder with built-in rotator. It supports the following decoding options: least-squares (LS), spatial re-sampling (SPR), Time-alignment (TA), Magnitude Least-Squares (MagLS).</li>
<li><b>ambi_dec</b> - a frequency-dependent Ambisonic decoder. It supports the following decoding options: sampling Ambisonic decoder (SAD), AllRAD, Energy-Preserving decoder (EPAD), Mode-Matching decoder (MMD).</li>
<li><b>ambi_drc</b> - a frequency-dependent dynamic range compressor (DRC) for Ambisonic signals.</li>
<li><b>ambi_enc</b> - a basic Ambisonic encoder.</li>
<li><b>ambi_roomsim</b> - an Ambisonic encoder that also includes reflections and source distance based on an image-source model of a shoebox room. Multiple sources and Ambisonic receivers are supported.</li>
<li><b>array2sh</b> - converts microphone array signals into spherical harmonic signals (aka Ambisonic signals), based on theoretical descriptions of the array configuration and construction.</li>
<li><b>beamformer</b> - a beamformer/virtual microphone generator for Ambisonic signals, with several different beam pattern options.</li>
<li><b>binauraliser</b> - convolves input audio with interpolated HRTFs, which can be optionally loaded from a SOFA file.</li>
<li><b>binauraliser_nf</b> - binauraliser, with the addition of proximity filtering for near field sound sources.</li>
<li><b>decorrelator</b> - a basic multi-channel signal decorrelator.</li>
<li><b>dirass</b> - a sound-field visualiser based on re-assigning the energy of beamformers. This re-assignment is based on the DoA estimates extracted from spatially-localised active-intensity vectors, which are biased towards each beamformer direction.</li>
<li><b>matrixconv</b> - a basic matrix convolver with an optional partitioned convolution mode.</li>
<li><b>multiconv</b> - a basic multi-channel convolver with an optional partitioned convolution mode.</li>
<li><b>tvconv</b> - a time-varying partitioned convolution multi-channel convolver for SOFA files containing RIRs with multiple listener positions.</li>
<li><b>panner</b> - a frequency-dependent VBAP panner, which accommodates a source loudness compensation (as a function of the room) option.</li>
<li><b>pitch_shifter</b> - a basic multi-channel pitch shifter, based on the phase vocoder approach.</li>
<li><b>powermap</b> - sound-field visualiser based on beamformer (PWD, MVDR) energy or subspace methods (MUSIC).</li>
<li><b>rotator</b> - rotates spherical harmonic signals (aka Ambisonic signals) given yaw-pitch-roll Euler rotation angles.</li>
<li><b>sldoa</b> - a sound-field visualiser based on directly depicting the DoA estimates extracted from multiple spatially-localised active-intensity vectors for multiple frequencies.</li>
<li><b>spreader</b> - an arbitrary array panner (HRIRs, microphone array IRs, etc.) with coherent and incoherent spreading modes.</li>
</ul>
<p >Many of these examples have also been released as VST audio plug-ins under the <a href="https://github.com/leomccormack/SPARTA">SPARTA</a> banner. The following open-source projects also employ the framework: <a href="https://github.com/leomccormack/Super-Hearing/">Super-Hearing</a>, <a href="https://github.com/leomccormack/HO-SIRR-GUI">HO-SIRR-GUI</a>, and <a href="https://github.com/leomccormack/CroPaC-Binaural">CroPaC-Binaural</a>.</p>
<h2><a class="anchor" id="autotoc_md103"></a>
Extras</h2>
<p >The repository also includes the following <b>extras</b>:</p>
<ul>
<li><a class="el" href="md_extras_matlab__s_a_f__m_a_t_l_a_b__c_o_d_e.html">matlab</a> - a bunch of MATLAB scripts/functions to accompany the framework (a script to generate <a class="el" href="saf__default__hrirs_8c.html" title="Default HRIR data.">saf_default_hrirs.c</a>, MATLAB versions of certain SAF functions, etc.).</li>
<li><a class="el" href="md_extras_safmex__s_a_f_m_e_x.html">safmex</a> - a bunch of MATLAB MEX wrappers, which allow certain SAF functions to be used within MATLAB.</li>
<li><a class="el" href="md_extras_safpy__s_a_f_p_y.html">safpy</a> - a work-in-progress initiative to bring SAF functionality to Python.</li>
<li><a class="el" href="md_extras_safwwise__s_a_f_w_w_i_s_e.html">safwwise</a> - a proof of concept regarding how one might integrate SAF into Wwise.</li>
</ul>
<h2><a class="anchor" id="autotoc_md104"></a>
Contributing</h2>
<p >Suggestions and contributions to the code are both welcomed and encouraged. It should be highlighted that the framework has been designed to be highly modular with plenty of room for expansion. Therefore:</p><ul>
<li>if you are researcher who has developed a spatial-audio related method and want to integrate it into the framework... or</li>
<li>if you notice that an existing piece of code can be rewritten to make it clearer, faster, or to fix a bug...</li>
</ul>
<p >then please feel free to do so and submit a pull request. We may also be able to help with the implementation if needed, just get in touch :- )</p>
<h2><a class="anchor" id="autotoc_md105"></a>
Contributors</h2>
<ul>
<li><b>Leo McCormack</b> - C programming and algorithm design (contact: leo.mccormack(at)aalto.fi)</li>
<li><b>Symeon Delikaris-Manias</b> - algorithm design</li>
<li><b>Archontis Politis</b> - algorithm design</li>
<li><b>Ville Pulkki</b> - algorithm design</li>
<li><b>Juhani Paasonen</b> - C programming</li>
<li><b>Chris Hold</b> - C programming and algorithm design</li>
<li><b>Janani Fernandez</b> - C programming and algorithm design</li>
</ul>
<h1><a class="anchor" id="autotoc_md106"></a>
License</h1>
<p >This software is dual-licensed. By default, this software is provided permissively under the terms of the <a href="https://choosealicense.com/licenses/isc/">ISC License</a>; since all of the core (non-optional) modules are licensed as such. However, including and enabling certain optional modules, which are instead provided under the copy-left <a href="https://choosealicense.com/licenses/gpl-2.0/">GNU GPLv2 License</a>, will mean that the use of this software is instead governed by the GNU GPLv2 licencing terms.</p>
<p >For full licensing terms see LICENSE.md.</p>
<p >Note that while we do not impose any copyleft licensing philosophies for the ISC licensed modules, we still appreciate it when improvements and/or bug fixes are also merged into this public repository where possible :-) </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sat Apr 2 2022 12:09:23 for SAF by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
<script type="text/javascript">
  $(function() {
      $(document).ready(function(){
         toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
         toggleButton.title = "Toggle Light/Dark Mode"
         document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
     })
  })
</script>
</body>
</html>
